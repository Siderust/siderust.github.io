---
/**
 * Sponsor Section
 *
 * Reusable sponsorship section with tiers and licensing note.
 */
import siteConfig from '../site.config';

const sponsorship = siteConfig.sponsorship;
const isEnabled = sponsorship?.enabled ?? false;

const defaultTiers = [
  {
    name: 'Individual',
    priceLabel: '$5+ / month',
    bulletPoints: [
      'Sustain open-source maintenance',
      'Early visibility into roadmap topics',
      'Community acknowledgement (optional)',
    ],
  },
  {
    name: 'Supporter',
    priceLabel: '$50+ / month',
    bulletPoints: [
      'Best-effort priority issue triage',
      'Input on roadmap focus areas',
      'Name or logo listed on the site (optional)',
    ],
    recommended: true,
  },
  {
    name: 'Company',
    priceLabel: '$500+ / month',
    bulletPoints: [
      'Best-effort response for critical issues',
      'Maintenance and security focus alignment',
      'Quarterly sponsor updates',
    ],
  },
  {
    name: 'Strategic / Custom',
    priceLabel: 'Let’s talk',
    bulletPoints: [
      'Custom work discussions (if appropriate)',
      'Joint roadmap planning on a best-effort basis',
      'Commercial licensing conversations',
    ],
  },
];

const defaultLicensingNote = `Our open-source code is released under the **GNU AGPL** by default.
For sponsors, we can discuss an alternative, less restrictive license for specific deliverables or usage.
This is handled **case-by-case** and subject to a separate written agreement.`;

const tiers = sponsorship?.tiers?.length ? sponsorship.tiers : defaultTiers;
const githubSponsorsUrl = sponsorship?.githubSponsorsUrl ?? '';
const contactEmail = sponsorship?.contactEmail ?? '';
const licensingNote = sponsorship?.licensingNote ?? defaultLicensingNote;
const licensingParagraphs = licensingNote
  .split('\n')
  .map((paragraph) => paragraph.trim())
  .filter(Boolean);
---

{isEnabled && (
  <section id="sponsor" class="py-20 md:py-28 bg-gray-50 dark:bg-gray-900/60">
    <div class="container-custom">
      <div class="max-w-3xl">
        <p class="text-sm uppercase tracking-[0.2em] text-brand-600 dark:text-brand-400 font-semibold">
          Sponsorship
        </p>
        <h2 class="mt-4 text-3xl sm:text-4xl font-bold tracking-tight text-gray-900 dark:text-white">
          Sponsor Siderust
        </h2>
        <p class="mt-4 text-lg text-gray-600 dark:text-gray-400">
          Help sustain open-source maintenance, roadmap work, and responsive support for Siderust’s ecosystem.
          Sponsorship keeps critical libraries reliable for research teams and production systems alike.
        </p>
      </div>

      <div class="mt-12 grid gap-6 lg:grid-cols-4">
        {tiers.map((tier) => (
          <article
            class:list={[
              'relative rounded-2xl border p-6 bg-white dark:bg-gray-950/70 shadow-sm transition-transform duration-200 hover:-translate-y-1',
              tier.recommended
                ? 'border-brand-500/70 shadow-brand-500/10'
                : 'border-gray-200 dark:border-gray-800',
            ]}
          >
            {tier.recommended && (
              <span class="absolute -top-3 left-6 badge bg-brand-600 text-white">
                Recommended
              </span>
            )}
            <h3 class="text-xl font-semibold text-gray-900 dark:text-white">
              {tier.name}
            </h3>
            <p class="mt-2 text-lg font-semibold text-brand-600 dark:text-brand-400">
              {tier.priceLabel}
            </p>
            <ul class="mt-4 space-y-3 text-sm text-gray-600 dark:text-gray-400">
              {tier.bulletPoints.map((point) => (
                <li class="flex items-start gap-2">
                  <svg class="mt-0.5 h-4 w-4 text-brand-500" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                    <path fill-rule="evenodd" d="M16.704 5.29a1 1 0 010 1.415l-7.25 7.25a1 1 0 01-1.414 0l-3.25-3.25a1 1 0 111.414-1.415l2.543 2.543 6.543-6.543a1 1 0 011.414 0z" clip-rule="evenodd" />
                  </svg>
                  <span>{point}</span>
                </li>
              ))}
            </ul>
          </article>
        ))}
      </div>

      <div class="mt-12 grid gap-6 lg:grid-cols-[2fr,1fr]">
        <div class="rounded-2xl border border-gray-200 dark:border-gray-800 bg-white/70 dark:bg-gray-950/70 p-6 md:p-8">
          <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Commercial licensing for sponsors</h3>
          <div class="mt-4 space-y-3 text-sm text-gray-600 dark:text-gray-400">
            {licensingParagraphs.map((paragraph) => (
              <p set:html={paragraph.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')} />
            ))}
          </div>
          <p class="mt-4 text-xs text-gray-500 dark:text-gray-500">
            This page is informational and not legal advice.
          </p>
        </div>

        <div class="rounded-2xl border border-gray-200 dark:border-gray-800 bg-gray-900 text-white p-6 md:p-8">
          <h3 class="text-lg font-semibold">Ready to support?</h3>
          <p class="mt-3 text-sm text-gray-200">
            Choose GitHub Sponsors for instant support, or reach out to discuss a tailored sponsorship plan.
          </p>
          <div class="mt-6 flex flex-col gap-3">
            {githubSponsorsUrl && (
              <a
                href={githubSponsorsUrl}
                target="_blank"
                rel="noopener noreferrer"
                class="btn bg-white text-gray-900 hover:bg-gray-100"
              >
                <svg class="h-4 w-4" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                  <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
                </svg>
                GitHub Sponsors
              </a>
            )}
            {contactEmail && (
              <a
                href={`mailto:${contactEmail}`}
                class="btn bg-white/10 text-white hover:bg-white/20"
              >
                Talk to us
              </a>
            )}
          </div>
        </div>
      </div>
    </div>
  </section>
)}
